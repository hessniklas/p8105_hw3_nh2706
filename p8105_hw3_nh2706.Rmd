---
title: "hw3"
author: "Niklas Hess"
date: "10/14/2022"
output: github_document
---

```{r}
library(tidyverse)
library(patchwork)
library(ggridges)
library(p8105.datasets)
```

#Problem 1
Omitted, as solutions are provided by Professor. 

#Problem 2


#Problem 3

### Load the data from the p8105.datasets

```{r}
data("ny_noaa")
```

### Data description
The data shows `r ncol(ny_noaa)` variables (`r names(ny_noaa)`) from New York state weather stations from January 1, 1981 through December 31, 2010. It has `r nrow(ny_noaa)` obersvations. Key variables include `r names(ny_noaa)[1]`, which denotes the weather station ID, and `r names(ny_noaa)[2]`, which indicates the date of each subsequent observation. Since each weather station might not collect all variables, missing data is a major issue in the context of this data.

### Data cleaning.
```{r}
clean_noaa_df = ny_noaa %>%
  janitor::clean_names() %>%
  separate(date, into = c("year", "month", "day"), sep = '-') %>%
  mutate(month = as.numeric(month),
         year = as.numeric(year),
         month = factor(month.abb[month], levels = month.abb),
         tmax = as.numeric(tmax)/10,
         tmin = as.numeric(tmin)/10,
         prcp = as.numeric(prcp)/10)
```


### Mode for Snow
```{r}
find_mode <- function(a) {
  value <- unique(a)
  tab <- tabulate(match(a, value))
  value[tab == max(tab)]
}
```

The most commonly observed values for snowfall are `r find_mode(clean_noaa_df$snow)`, which makes sense because most of the year there is no snow-fall.

### Two-panel plot showing the average max temperature in January and in July in each station across years

```{r}
mean_max_temp = clean_noaa_df %>%
  filter(month == "Jan" | month == "Jul") %>%  
  group_by(id, year, month) %>% 
  summarize(mean_temperature = mean(tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = year, y = mean_temperature, group = id)) +
  geom_line() +
  facet_grid(. ~ month) +
  labs(
    title = "Max temperature in January and in July in each station across years",
    x = "Years among weather stations",
    y = "Mean_Max_temperature",
    caption = "Data from ny_noaa") +
  theme(legend.position = "none")

mean_max_temp
```

  
Is there any observable / interpretable structure? Any outliers?

### Two-panel plot showing tmax vs tmin for the full dataset 

```{r}
maxmin_plot = clean_noaa_df %>%
  ggplot(aes(x = tmax, y = tmin)) +
  geom_hex() +
  labs(title = "Max vs Min Temp over years",
       x = "Max Temp (C)",
       y = "Min Temp (C)",
       caption = "Data from NY NOAA.")
```

```{r}
snowfall_plot = clean_noaa_df %>%
  filter(snow > 0, snow < 100) %>%
  ggplot(aes(x = year, y = year)) +
  geom_line() +
  labs(title = "Snowfall Distribution by Year (0-100 mm)",
       x = "Snowfall (mm)",
       y = "Year",
       caption = "Data from NY NOAA.")
```

```{r}
maxmin_plot + snowfall_plot
```

